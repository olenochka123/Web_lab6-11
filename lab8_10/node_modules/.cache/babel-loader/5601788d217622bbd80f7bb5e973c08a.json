{"ast":null,"code":"import { useReducer, useEffect, useRef, useMemo } from 'react';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar isObject = function (val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n\nvar snapshotToData = function (snapshot, keyField) {\n  if (!snapshot.exists) {\n    return undefined;\n  }\n\n  var val = snapshot.val();\n\n  if (isObject(val)) {\n    return __assign({}, val, keyField ? (_a = {}, _a[keyField] = snapshot.key, _a) : null);\n  }\n\n  return val;\n\n  var _a;\n};\n\nvar initialState = {\n  loading: true,\n  value: {\n    keys: [],\n    values: []\n  }\n};\n\nvar listReducer = function (state, action) {\n  switch (action.type) {\n    case 'add':\n      if (!action.snapshot) {\n        return state;\n      }\n\n      return __assign({}, state, {\n        error: undefined,\n        value: addChild(state.value, action.snapshot, action.previousKey)\n      });\n\n    case 'change':\n      if (!action.snapshot) {\n        return state;\n      }\n\n      return __assign({}, state, {\n        error: undefined,\n        value: changeChild(state.value, action.snapshot)\n      });\n\n    case 'error':\n      return __assign({}, state, {\n        error: action.error,\n        loading: false,\n        value: {\n          keys: undefined,\n          values: undefined\n        }\n      });\n\n    case 'move':\n      if (!action.snapshot) {\n        return state;\n      }\n\n      return __assign({}, state, {\n        error: undefined,\n        value: moveChild(state.value, action.snapshot, action.previousKey)\n      });\n\n    case 'remove':\n      if (!action.snapshot) {\n        return state;\n      }\n\n      return __assign({}, state, {\n        error: undefined,\n        value: removeChild(state.value, action.snapshot)\n      });\n\n    case 'reset':\n      return initialState;\n\n    case 'value':\n      return __assign({}, state, {\n        error: undefined,\n        loading: false\n      });\n\n    case 'empty':\n      return __assign({}, state, {\n        loading: false,\n        value: {\n          keys: undefined,\n          values: undefined\n        }\n      });\n\n    default:\n      return state;\n  }\n};\n\nvar addChild = function (currentState, snapshot, previousKey) {\n  if (!snapshot.key) {\n    return currentState;\n  }\n\n  var keys = currentState.keys,\n      values = currentState.values;\n\n  if (!previousKey) {\n    // The child has been added to the start of the list\n    return {\n      keys: keys ? [snapshot.key].concat(keys) : [snapshot.key],\n      values: values ? [snapshot].concat(values) : [snapshot]\n    };\n  } // Establish the index for the previous child in the list\n\n\n  var index = keys ? keys.indexOf(previousKey) : 0; // Insert the item after the previous child\n\n  return {\n    keys: keys ? keys.slice(0, index + 1).concat([snapshot.key], keys.slice(index + 1)) : [snapshot.key],\n    values: values ? values.slice(0, index + 1).concat([snapshot], values.slice(index + 1)) : [snapshot]\n  };\n};\n\nvar changeChild = function (currentState, snapshot) {\n  if (!snapshot.key) {\n    return currentState;\n  }\n\n  var keys = currentState.keys,\n      values = currentState.values;\n  var index = keys ? keys.indexOf(snapshot.key) : 0;\n  return __assign({}, currentState, {\n    values: values ? values.slice(0, index).concat([snapshot], values.slice(index + 1)) : [snapshot]\n  });\n};\n\nvar removeChild = function (currentState, snapshot) {\n  if (!snapshot.key) {\n    return currentState;\n  }\n\n  var keys = currentState.keys,\n      values = currentState.values;\n  var index = keys ? keys.indexOf(snapshot.key) : 0;\n  return {\n    keys: keys ? keys.slice(0, index).concat(keys.slice(index + 1)) : [],\n    values: values ? values.slice(0, index).concat(values.slice(index + 1)) : []\n  };\n};\n\nvar moveChild = function (currentState, snapshot, previousKey) {\n  // Remove the child from it's previous location\n  var tempValue = removeChild(currentState, snapshot); // Add the child into it's new location\n\n  return addChild(tempValue, snapshot, previousKey);\n};\n\nvar useListReducer = function () {\n  return useReducer(listReducer, initialState);\n};\n\nvar defaultState = function (defaultValue) {\n  return {\n    loading: defaultValue === undefined || defaultValue === null,\n    value: defaultValue\n  };\n};\n\nvar reducer = function () {\n  return function (state, action) {\n    switch (action.type) {\n      case 'error':\n        return __assign({}, state, {\n          error: action.error,\n          loading: false,\n          value: undefined\n        });\n\n      case 'reset':\n        return defaultState(action.defaultValue);\n\n      case 'value':\n        return __assign({}, state, {\n          error: undefined,\n          loading: false,\n          value: action.value\n        });\n\n      default:\n        return state;\n    }\n  };\n};\n\nvar useLoadingValue = function (getDefaultValue) {\n  var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n\n  var _a = useReducer(reducer(), defaultState(defaultValue)),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var reset = function () {\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\n    dispatch({\n      type: 'reset',\n      defaultValue: defaultValue\n    });\n  };\n\n  var setError = function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  };\n\n  var setValue = function (value) {\n    dispatch({\n      type: 'value',\n      value: value\n    });\n  };\n\n  return {\n    error: state.error,\n    loading: state.loading,\n    reset: reset,\n    setError: setError,\n    setValue: setValue,\n    value: state.value\n  };\n};\n\nvar useComparatorRef = function (value, isEqual, onChange) {\n  var ref = useRef(value);\n  useEffect(function () {\n    if (!isEqual(value, ref.current)) {\n      ref.current = value;\n\n      if (onChange) {\n        onChange();\n      }\n    }\n  });\n  return ref;\n};\n\nvar isEqual = function (v1, v2) {\n  var bothNull = !v1 && !v2;\n  var equal = !!v1 && !!v2 && v1.isEqual(v2);\n  return bothNull || equal;\n};\n\nvar useIsEqualRef = function (value, onChange) {\n  return useComparatorRef(value, isEqual, onChange);\n};\n\nvar useList = function (query) {\n  var _a = useListReducer(),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var ref = useIsEqualRef(query, function () {\n    return dispatch({\n      type: 'reset'\n    });\n  });\n\n  var onChildAdded = function (snapshot, previousKey) {\n    dispatch({\n      type: 'add',\n      previousKey: previousKey,\n      snapshot: snapshot\n    });\n  };\n\n  var onChildChanged = function (snapshot) {\n    dispatch({\n      type: 'change',\n      snapshot: snapshot\n    });\n  };\n\n  var onChildMoved = function (snapshot, previousKey) {\n    dispatch({\n      type: 'move',\n      previousKey: previousKey,\n      snapshot: snapshot\n    });\n  };\n\n  var onChildRemoved = function (snapshot) {\n    dispatch({\n      type: 'remove',\n      snapshot: snapshot\n    });\n  };\n\n  var onError = function (error) {\n    dispatch({\n      type: 'error',\n      error: error\n    });\n  };\n\n  var onValue = function () {\n    dispatch({\n      type: 'value'\n    });\n  };\n\n  useEffect(function () {\n    var query = ref.current;\n\n    if (!query) {\n      dispatch({\n        type: 'empty'\n      });\n      return;\n    } // This is here to indicate that all the data has been successfully received\n\n\n    query.once('value', onValue, onError);\n    query.on('child_added', onChildAdded, onError);\n    query.on('child_changed', onChildChanged, onError);\n    query.on('child_moved', onChildMoved, onError);\n    query.on('child_removed', onChildRemoved, onError);\n    return function () {\n      query.off('child_added', onChildAdded);\n      query.off('child_changed', onChildChanged);\n      query.off('child_moved', onChildMoved);\n      query.off('child_removed', onChildRemoved);\n    };\n  }, [ref.current]);\n  return [state.value.values, state.loading, state.error];\n};\n\nvar useListKeys = function (query) {\n  var _a = useList(query),\n      value = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  return [value ? value.map(function (snapshot) {\n    return snapshot.key;\n  }) : undefined, loading, error];\n};\n\nvar useListVals = function (query, options) {\n  var _a = useList(query),\n      snapshots = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var values = useMemo(function () {\n    return snapshots ? snapshots.map(function (snapshot) {\n      return snapshotToData(snapshot, options ? options.keyField : undefined);\n    }) : undefined;\n  }, [snapshots, options && options.keyField]);\n  return [values, loading, error];\n};\n\nvar useObject = function (query) {\n  var _a = useLoadingValue(),\n      error = _a.error,\n      loading = _a.loading,\n      reset = _a.reset,\n      setError = _a.setError,\n      setValue = _a.setValue,\n      value = _a.value;\n\n  var ref = useIsEqualRef(query, reset);\n  useEffect(function () {\n    var query = ref.current;\n\n    if (!query) {\n      setValue(undefined);\n      return;\n    }\n\n    query.on('value', setValue, setError);\n    return function () {\n      query.off('value', setValue);\n    };\n  }, [ref.current]);\n  return [value, loading, error];\n};\n\nvar useObjectVal = function (query, options) {\n  var _a = useObject(query),\n      snapshot = _a[0],\n      loading = _a[1],\n      error = _a[2];\n\n  var value = useMemo(function () {\n    return snapshot ? snapshotToData(snapshot, options ? options.keyField : undefined) : undefined;\n  }, [snapshot, options && options.keyField]);\n  return [value, loading, error];\n};\n\nexport { useList, useListKeys, useListVals, useObject, useObjectVal };","map":{"version":3,"sources":["/Users/olenafito/WebstormProjects/react-firebase/node_modules/react-firebase-hooks/database/dist/index.esm.js"],"names":["useReducer","useEffect","useRef","useMemo","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","isObject","val","Array","isArray","snapshotToData","snapshot","keyField","exists","undefined","_a","key","initialState","loading","value","keys","values","listReducer","state","action","type","error","addChild","previousKey","changeChild","moveChild","removeChild","currentState","concat","index","indexOf","slice","tempValue","useListReducer","defaultState","defaultValue","reducer","useLoadingValue","getDefaultValue","dispatch","reset","setError","setValue","useComparatorRef","isEqual","onChange","ref","current","v1","v2","bothNull","equal","useIsEqualRef","useList","query","onChildAdded","onChildChanged","onChildMoved","onChildRemoved","onError","onValue","once","on","off","useListKeys","map","useListVals","options","snapshots","useObject","useObjectVal"],"mappings":"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","sourcesContent":["import { useReducer, useEffect, useRef, useMemo } from 'react';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar isObject = function (val) {\r\n    return val != null && typeof val === 'object' && Array.isArray(val) === false;\r\n};\r\nvar snapshotToData = function (snapshot, keyField) {\r\n    if (!snapshot.exists) {\r\n        return undefined;\r\n    }\r\n    var val = snapshot.val();\r\n    if (isObject(val)) {\r\n        return __assign({}, val, (keyField ? (_a = {}, _a[keyField] = snapshot.key, _a) : null));\r\n    }\r\n    return val;\r\n    var _a;\r\n};\n\nvar initialState = {\r\n    loading: true,\r\n    value: {\r\n        keys: [],\r\n        values: [],\r\n    },\r\n};\r\nvar listReducer = function (state, action) {\r\n    switch (action.type) {\r\n        case 'add':\r\n            if (!action.snapshot) {\r\n                return state;\r\n            }\r\n            return __assign({}, state, { error: undefined, value: addChild(state.value, action.snapshot, action.previousKey) });\r\n        case 'change':\r\n            if (!action.snapshot) {\r\n                return state;\r\n            }\r\n            return __assign({}, state, { error: undefined, value: changeChild(state.value, action.snapshot) });\r\n        case 'error':\r\n            return __assign({}, state, { error: action.error, loading: false, value: {\r\n                    keys: undefined,\r\n                    values: undefined,\r\n                } });\r\n        case 'move':\r\n            if (!action.snapshot) {\r\n                return state;\r\n            }\r\n            return __assign({}, state, { error: undefined, value: moveChild(state.value, action.snapshot, action.previousKey) });\r\n        case 'remove':\r\n            if (!action.snapshot) {\r\n                return state;\r\n            }\r\n            return __assign({}, state, { error: undefined, value: removeChild(state.value, action.snapshot) });\r\n        case 'reset':\r\n            return initialState;\r\n        case 'value':\r\n            return __assign({}, state, { error: undefined, loading: false });\r\n        case 'empty':\r\n            return __assign({}, state, { loading: false, value: {\r\n                    keys: undefined,\r\n                    values: undefined,\r\n                } });\r\n        default:\r\n            return state;\r\n    }\r\n};\r\nvar addChild = function (currentState, snapshot, previousKey) {\r\n    if (!snapshot.key) {\r\n        return currentState;\r\n    }\r\n    var keys = currentState.keys, values = currentState.values;\r\n    if (!previousKey) {\r\n        // The child has been added to the start of the list\r\n        return {\r\n            keys: keys ? [snapshot.key].concat(keys) : [snapshot.key],\r\n            values: values ? [snapshot].concat(values) : [snapshot],\r\n        };\r\n    }\r\n    // Establish the index for the previous child in the list\r\n    var index = keys ? keys.indexOf(previousKey) : 0;\r\n    // Insert the item after the previous child\r\n    return {\r\n        keys: keys\r\n            ? keys.slice(0, index + 1).concat([snapshot.key], keys.slice(index + 1)) : [snapshot.key],\r\n        values: values\r\n            ? values.slice(0, index + 1).concat([snapshot], values.slice(index + 1)) : [snapshot],\r\n    };\r\n};\r\nvar changeChild = function (currentState, snapshot) {\r\n    if (!snapshot.key) {\r\n        return currentState;\r\n    }\r\n    var keys = currentState.keys, values = currentState.values;\r\n    var index = keys ? keys.indexOf(snapshot.key) : 0;\r\n    return __assign({}, currentState, { values: values\r\n            ? values.slice(0, index).concat([snapshot], values.slice(index + 1)) : [snapshot] });\r\n};\r\nvar removeChild = function (currentState, snapshot) {\r\n    if (!snapshot.key) {\r\n        return currentState;\r\n    }\r\n    var keys = currentState.keys, values = currentState.values;\r\n    var index = keys ? keys.indexOf(snapshot.key) : 0;\r\n    return {\r\n        keys: keys ? keys.slice(0, index).concat(keys.slice(index + 1)) : [],\r\n        values: values\r\n            ? values.slice(0, index).concat(values.slice(index + 1)) : [],\r\n    };\r\n};\r\nvar moveChild = function (currentState, snapshot, previousKey) {\r\n    // Remove the child from it's previous location\r\n    var tempValue = removeChild(currentState, snapshot);\r\n    // Add the child into it's new location\r\n    return addChild(tempValue, snapshot, previousKey);\r\n};\r\nvar useListReducer = (function () { return useReducer(listReducer, initialState); });\n\nvar defaultState = function (defaultValue) {\r\n    return {\r\n        loading: defaultValue === undefined || defaultValue === null,\r\n        value: defaultValue,\r\n    };\r\n};\r\nvar reducer = function () { return function (state, action) {\r\n    switch (action.type) {\r\n        case 'error':\r\n            return __assign({}, state, { error: action.error, loading: false, value: undefined });\r\n        case 'reset':\r\n            return defaultState(action.defaultValue);\r\n        case 'value':\r\n            return __assign({}, state, { error: undefined, loading: false, value: action.value });\r\n        default:\r\n            return state;\r\n    }\r\n}; };\r\nvar useLoadingValue = (function (getDefaultValue) {\r\n    var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n    var _a = useReducer(reducer(), defaultState(defaultValue)), state = _a[0], dispatch = _a[1];\r\n    var reset = function () {\r\n        var defaultValue = getDefaultValue ? getDefaultValue() : undefined;\r\n        dispatch({ type: 'reset', defaultValue: defaultValue });\r\n    };\r\n    var setError = function (error) {\r\n        dispatch({ type: 'error', error: error });\r\n    };\r\n    var setValue = function (value) {\r\n        dispatch({ type: 'value', value: value });\r\n    };\r\n    return {\r\n        error: state.error,\r\n        loading: state.loading,\r\n        reset: reset,\r\n        setError: setError,\r\n        setValue: setValue,\r\n        value: state.value,\r\n    };\r\n});\n\nvar useComparatorRef = function (value, isEqual, onChange) {\r\n    var ref = useRef(value);\r\n    useEffect(function () {\r\n        if (!isEqual(value, ref.current)) {\r\n            ref.current = value;\r\n            if (onChange) {\r\n                onChange();\r\n            }\r\n        }\r\n    });\r\n    return ref;\r\n};\r\nvar isEqual = function (v1, v2) {\r\n    var bothNull = !v1 && !v2;\r\n    var equal = !!v1 && !!v2 && v1.isEqual(v2);\r\n    return bothNull || equal;\r\n};\r\nvar useIsEqualRef = function (value, onChange) {\r\n    return useComparatorRef(value, isEqual, onChange);\r\n};\n\nvar useList = function (query) {\r\n    var _a = useListReducer(), state = _a[0], dispatch = _a[1];\r\n    var ref = useIsEqualRef(query, function () { return dispatch({ type: 'reset' }); });\r\n    var onChildAdded = function (snapshot, previousKey) {\r\n        dispatch({ type: 'add', previousKey: previousKey, snapshot: snapshot });\r\n    };\r\n    var onChildChanged = function (snapshot) {\r\n        dispatch({ type: 'change', snapshot: snapshot });\r\n    };\r\n    var onChildMoved = function (snapshot, previousKey) {\r\n        dispatch({ type: 'move', previousKey: previousKey, snapshot: snapshot });\r\n    };\r\n    var onChildRemoved = function (snapshot) {\r\n        dispatch({ type: 'remove', snapshot: snapshot });\r\n    };\r\n    var onError = function (error) {\r\n        dispatch({ type: 'error', error: error });\r\n    };\r\n    var onValue = function () {\r\n        dispatch({ type: 'value' });\r\n    };\r\n    useEffect(function () {\r\n        var query = ref.current;\r\n        if (!query) {\r\n            dispatch({ type: 'empty' });\r\n            return;\r\n        }\r\n        // This is here to indicate that all the data has been successfully received\r\n        query.once('value', onValue, onError);\r\n        query.on('child_added', onChildAdded, onError);\r\n        query.on('child_changed', onChildChanged, onError);\r\n        query.on('child_moved', onChildMoved, onError);\r\n        query.on('child_removed', onChildRemoved, onError);\r\n        return function () {\r\n            query.off('child_added', onChildAdded);\r\n            query.off('child_changed', onChildChanged);\r\n            query.off('child_moved', onChildMoved);\r\n            query.off('child_removed', onChildRemoved);\r\n        };\r\n    }, [ref.current]);\r\n    return [state.value.values, state.loading, state.error];\r\n};\r\nvar useListKeys = function (query) {\r\n    var _a = useList(query), value = _a[0], loading = _a[1], error = _a[2];\r\n    return [\r\n        value ? value.map(function (snapshot) { return snapshot.key; }) : undefined,\r\n        loading,\r\n        error,\r\n    ];\r\n};\r\nvar useListVals = function (query, options) {\r\n    var _a = useList(query), snapshots = _a[0], loading = _a[1], error = _a[2];\r\n    var values = useMemo(function () {\r\n        return snapshots\r\n            ? snapshots.map(function (snapshot) {\r\n                return snapshotToData(snapshot, options ? options.keyField : undefined);\r\n            })\r\n            : undefined;\r\n    }, [snapshots, options && options.keyField]);\r\n    return [values, loading, error];\r\n};\n\nvar useObject = function (query) {\r\n    var _a = useLoadingValue(), error = _a.error, loading = _a.loading, reset = _a.reset, setError = _a.setError, setValue = _a.setValue, value = _a.value;\r\n    var ref = useIsEqualRef(query, reset);\r\n    useEffect(function () {\r\n        var query = ref.current;\r\n        if (!query) {\r\n            setValue(undefined);\r\n            return;\r\n        }\r\n        query.on('value', setValue, setError);\r\n        return function () {\r\n            query.off('value', setValue);\r\n        };\r\n    }, [ref.current]);\r\n    return [value, loading, error];\r\n};\r\nvar useObjectVal = function (query, options) {\r\n    var _a = useObject(query), snapshot = _a[0], loading = _a[1], error = _a[2];\r\n    var value = useMemo(function () {\r\n        return snapshot\r\n            ? snapshotToData(snapshot, options ? options.keyField : undefined)\r\n            : undefined;\r\n    }, [snapshot, options && options.keyField]);\r\n    return [value, loading, error];\r\n};\n\nexport { useList, useListKeys, useListVals, useObject, useObjectVal };\n"]},"metadata":{},"sourceType":"module"}